#!/bin/bash
# Ð¤Ð˜ÐÐÐ›Ð¬ÐÐ«Ð™ Ð¡ÐšÐ Ð˜ÐŸÐ¢ Ð”Ð›Ð¯ Ð¢Ð’ÐžÐ•Ð“Ðž GitHub Pages

# 1. Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½ÑƒÑŽ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ
mkdir -p dists/stable/main/binary-iphoneos-arm64

# 2. Ð¤Ð¸ÐºÑÐ¸Ð¼ .deb + Ð¿ÐµÑ€ÐµÑÐ¾Ð±Ð¸Ñ€Ð°ÐµÐ¼
rm -rf temp/
for deb in debs/*.deb; do
  [ -f "$deb" ] || continue
  dpkg-deb -x "$deb" temp/
  cat > temp/DEBIAN/control << EOF
Package: $(dpkg-deb -f "$deb" Package 2>/dev/null || echo com.supermamont.nikitos)
Version: $(dpkg-deb -f "$deb" Version 2>/dev/null || echo 1.0.0-1)
Section: Tweaks
Architecture: iphoneos-arm64
Maintainer: Reposi3 <reposithree@gmail.com>
Depends: firmware (>=15.0)
Description: Nikitos tweak for rootless jailbreak
EOF
  dpkg-deb -b temp/ "$deb"
done
rm -rf temp/

# 3. Packages.gz Ð² ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐžÐœ Ð¼ÐµÑÑ‚Ðµ
dpkg-scanpackages debs/ /dev/null | gzip -c > dists/stable/main/binary-iphoneos-arm64/Packages.gz

# 4. Release
cat > Release << EOF
Architectures: iphoneos-arm64
Components: main
Origin: Reposi3
Label: Nikitos Repo
Suite: stable
Version: 1.0
Date: $(date -Ru)
EOF

# 5. Ð¥ÑÑˆÐ¸
cd dists/stable/main/binary-iphoneos-arm64/
sha1sum Packages.gz > SHA1Sums
sha256sum Packages.gz > SHA256Sums
cd ../../..

echo "âœ… Ð“ÐžÐ¢ÐžÐ’Ðž! git add . && git commit -m 'fix repo' && git push"
echo "ðŸ“± Sileo URL: https://nikitabelskii2014-cell.github.io/Repososi/"
